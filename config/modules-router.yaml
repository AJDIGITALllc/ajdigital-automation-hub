---
# Audio Jones Modules Router
# Declarative event routing specification for automation modules

version: "1.0"

# Event routing configuration
# Maps event names to module handlers with operational parameters
events:
  # Booking Lifecycle Events
  booking.created:
    modules:
      - client-delivery
      - marketing-automation
      - data-intelligence
    priority: high
    retries: 3
    timeoutMs: 30000

  booking.status_updated:
    modules:
      - client-delivery
      - data-intelligence
    priority: medium
    retries: 3
    timeoutMs: 20000

  booking.approved:
    modules:
      - client-delivery
      - marketing-automation
    priority: high
    retries: 3
    timeoutMs: 30000

  booking.completed:
    modules:
      - client-delivery
      - marketing-automation
      - data-intelligence
    priority: high
    retries: 3
    timeoutMs: 30000

  booking.cancelled:
    modules:
      - client-delivery
      - data-intelligence
    priority: medium
    retries: 2
    timeoutMs: 20000

  # Payment Events
  payment.intent_created:
    modules:
      - data-intelligence
    priority: medium
    retries: 2
    timeoutMs: 15000

  payment.completed:
    modules:
      - client-delivery
      - marketing-automation
      - data-intelligence
    priority: high
    retries: 5
    timeoutMs: 30000

  payment.failed:
    modules:
      - marketing-automation
      - data-intelligence
    priority: high
    retries: 3
    timeoutMs: 20000

  # Asset Events
  asset.uploaded:
    modules:
      - client-delivery
      - ai-optimization
      - data-intelligence
    priority: medium
    retries: 3
    timeoutMs: 60000

  asset.processed:
    modules:
      - client-delivery
      - ai-optimization
    priority: medium
    retries: 2
    timeoutMs: 30000

  asset.delivered:
    modules:
      - client-delivery
      - marketing-automation
    priority: high
    retries: 3
    timeoutMs: 30000

  # User Events
  user.registered:
    modules:
      - marketing-automation
    priority: medium
    retries: 2
    timeoutMs: 15000

  user.inactive:
    modules:
      - marketing-automation
    priority: low
    retries: 1
    timeoutMs: 10000

  # Content Events
  content.submitted_for_review:
    modules:
      - ai-optimization
    priority: medium
    retries: 2
    timeoutMs: 45000

  # Admin/Tenant Events
  tenant.config_updated:
    modules:
      - data-intelligence
    priority: low
    retries: 2
    timeoutMs: 15000

  reporting.snapshot_generated:
    modules:
      - data-intelligence
    priority: low
    retries: 1
    timeoutMs: 20000

  service.created:
    modules:
      - data-intelligence
    priority: low
    retries: 2
    timeoutMs: 15000

  service.whop_synced:
    modules:
      - data-intelligence
    priority: low
    retries: 2
    timeoutMs: 15000

# Dead letter queue configuration
deadLetter:
  enabled: true
  retentionDays: 30

# Global defaults (optional, can be overridden per event)
defaults:
  priority: medium
  retries: 2
  timeoutMs: 20000
